<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Authorization</title>
</head>
<body>
  <p>Completing authentication...</p>
  <script>
    (function() {
      // Get token from URL hash
      const params = new URLSearchParams(window.location.hash.substring(1));
      const token = params.get('access_token');
      
      if (token && window.opener) {
        // Send message in the format Netlify CMS expects
        window.opener.postMessage({
          type: 'authorization:github:success',
          token: token,
          provider: 'github'
        }, '*');
        
        // Close after a short delay
        setTimeout(() => window.close(), 500);
      } else {
        document.body.innerHTML = '<p style="color:red;">Error: No token found</p>';
      }
    })();
  </script>
</body>
</html>
